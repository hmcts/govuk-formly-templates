language: node_js
node_js:
- lts/*
cache:
  yarn: true
  directories:
  - node_modules
sudo: required
addons:
  chrome: stable
apt:
  sources:
  - google-chrome
  packages:
  - google-chrome-stable
  - google-chrome-beta
script:
- npm --version
- npm install
- npm test
- npm run package
after_success:
- npm run test:codecov-upload
- npm run test:coveralls-upload
before_deploy:
- cd dist/govuk-formly-templates
deploy:
  provider: npm
  email: jenkins-reform@hmcts.net
  api_key:
    secure: QCtjQIq8am0Yke4PFpdzvUKmZYJ0jesKtAwJyrr/GBKHO0e/bkH4cTmh27a5SR8Cz1Lr6+5ec4oODzf240AZ12HVQ/0lrG7kNWaE+8IXzNM95uJC5EY8uhiHBEQVeI8VVx9GScjFXk/EVP/SgPox4FFTlPNVaT2TQGXNOK/8JjiQ5vsyArrCUEsOhd4ryks8osONEkO/xV/cpd8SwaILN3OgmIc8pNwkWklFMVVlhI6aYPyIdPYR+00Lsi6ZHkrxamx/YXaGEwjy/aObFCFxVAlLRXpvlJVwiTKfrWxSpW0IEYeYoDF6G/V8Ix4/a+f3xa4DyQ91d7Zk4Ymz7Q6xmPmYx7P1J7c4gJJ1bphg4fvPZzl8VDRdUWdLJkkcdPxWp5XV0+mcX9lCC2Yd5junXYz62B5swy/hYHEtyQjbiBG7d+2lLyTZgG28kK9cH+1+zLHlv1ZD/LZA1+LDt+h0s70VNR/294O9XdFYegBc1Y7QKsTjvOgYb6MWPYNrAwLLxxdGKbNh4WwtKudw/fhW8/gbuY0BHrCZB3hHniCpNXeCfa1DiZyhTjeHuh/D2X9TC8/ITH+KNqpjsDdyFi8I3p9m2ERzV8PVw9xxLlesQ+nbR8pMsTqTBnIBdJwIoPNAr2I7BFxWsnUrfylcImyG1KfLHdzwGZ31MYYCg11/ZUU=
  skip_cleanup: true
  on:
    tags: true
    repo: hmcts/govuk-formly-templates
    all_branches: true
